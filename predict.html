<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Edumindcare ‚Äì ƒê√°nh gi√° c·∫£m x√∫c</title>
<link rel="preconnect" href="https://images.unsplash.com" crossorigin>
<style>
/* ===== Chatbot widget (Edumindcare style) ===== */
#chatbot-btn{
  position:fixed;
  right:22px;
  bottom:22px;
  width:62px;
  height:62px;
  border-radius:50%;
  background:var(--brand);
  color:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:26px;
  cursor:pointer;
  box-shadow:0 14px 34px rgba(59,130,246,.35);
  z-index:9999;
}

#chatbot-box{
  position:fixed;
  right:22px;
  bottom:96px;
  width:360px;
  max-height:520px;
  background:#fff;
  border-radius:18px;
  box-shadow:0 24px 60px rgba(17,24,39,.25);
  display:none;
  flex-direction:column;
  overflow:hidden;
  z-index:9999;
  border:1px solid var(--border);
}

#chatbot-header{
  background:linear-gradient(135deg, var(--brand), var(--brand-600));
  color:#fff;
  padding:14px 16px;
  font-weight:800;
  display:flex;
  align-items:center;
  gap:10px;
}

#chatbot-header span{
  font-size:14px;
  opacity:.9;
  font-weight:600;
}

#chatbot-messages{
  flex:1;
  padding:14px;
  overflow-y:auto;
  background:#f8fafc;
  display:flex;
  flex-direction:column;
  gap:10px;
  font-size:14px;
}

/* Bubble chat */
.chat-msg{
  max-width:82%;
  padding:10px 14px;
  border-radius:14px;
  line-height:1.5;
  animation:fadeUp .25s ease;
}

.chat-user{
  align-self:flex-end;
  background:var(--brand);
  color:#fff;
  border-bottom-right-radius:4px;
}

.chat-bot{
  align-self:flex-start;
  background:#fff;
  border:1px solid var(--border);
  color:#111;
  border-bottom-left-radius:4px;
}

#chatbot-input{
  display:flex;
  gap:8px;
  padding:12px;
  border-top:1px solid var(--border);
  background:#fff;
}

#chatbot-input input{
  flex:1;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--border);
  font-size:14px;
}

#chatbot-input input:focus{
  outline:none;
  border-color:var(--brand);
  box-shadow:0 0 0 3px rgba(59,130,246,.15);
}

#chatbot-input button{
  padding:10px 16px;
  border-radius:12px;
  border:none;
  background:var(--brand);
  color:#fff;
  font-weight:800;
  cursor:pointer;
}

#chatbot-input button:hover{
  background:var(--brand-600);
}

/* Animation */
@keyframes fadeUp{
  from{opacity:0; transform:translateY(6px)}
  to{opacity:1; transform:none}
}
  :root{
    --brand:#3b82f6;
    --ink:#111827;
    --muted:#4b5563;
    --bg:#ffffff;
    --border:#e5e7eb;
    --gray-50:#f8fafc;
  }
  body{margin:0; background:var(--bg); color:var(--ink); font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial}
  a{text-decoration:none; color:inherit}
  img{max-width:100%; display:block}
  .container{max-width:1260px; padding:0 24px; margin:0 auto}
  /* NAVBAR */
  .navbar{position:sticky; top:0; z-index:50; background:rgba(255,255,255,.95); border-bottom:1px solid var(--border); backdrop-filter:saturate(160%) blur(8px)}
  .nav-row{display:flex; align-items:center; justify-content:space-between; gap:16px; padding:14px 20px}
  .brand{font-weight:900; letter-spacing:.12em; font-size:28px; display:flex; align-items:center; gap:12px}
  .brand .logo{height:56px}
  .links{display:flex; gap:28px; font-weight:700; font-size:15px}
  /* PAGE CONTENT */
  .section{padding:64px 0}
  .grid{display:grid; grid-template-columns:1fr 1fr; gap:48px}
  @media(max-width:900px){ .grid{grid-template-columns:1fr} }
  .card{padding:24px; border:1px solid var(--border); background:white; border-radius:16px}
  .title{font-size:36px; font-weight:900; margin:0 0 12px}
  .lead{font-size:17px; color:var(--muted); line-height:1.6}
  video, img{border-radius:14px; width:100%; height:auto; object-fit:cover; background:#f0f4ff}
  .btn{padding:10px 16px; border-radius:10px; border:none; cursor:pointer; background:var(--brand); color:white; font-weight:600; margin-right:8px}
  .btn.secondary{background:#e5e7eb; color:#111}
  #resultBox{margin-top:18px; padding:18px; background:var(--gray-50); border-radius:14px; border:1px solid var(--border)}
  #emotion{font-size:28px; font-weight:800; color:#10b981}
  #conf{font-size:15px; color:var(--muted)}
  footer{padding:32px 0; border-top:1px solid var(--border); background:var(--bg); margin-top:40px}
  .footer-links{display:flex; gap:22px; justify-content:center; flex-wrap:wrap; font-weight:700; font-size:14px}
  .divider{height:1px; background:var(--border); max-width:820px; margin:12px auto}
  .footer-meta{display:flex; justify-content:space-between; align-items:center; gap:16px; max-width:820px; margin:0 auto; color:var(--muted); font-size:14px}
</style>
</head>
<body>
<header class="navbar">
    <nav class=" nav-row">
      <a class="brand" href="index.html"><img class="logo" src="logo.jpg" alt="Logo Tr·∫ßn ƒê·∫°i Nghƒ©a"><span>Edumindcare</span></a>
      <div class="links">
        <a href="about.html">Ph∆∞∆°ng ph√°p c·ªßa Ch√∫ng t√¥i</a>
        <a href="games.html">Nghe nh·∫°c v√† tr√≤ ch∆°i gi·∫£m cƒÉng th·∫≥ng</a>
        <a href="survey.html">Ki·ªÉm tra s·ª©c kh·ªèe t√¢m th·∫ßn</a>
	<a href="predict.html">ƒê√°nh gi√° c·∫£m x√∫c khu√¥n m·∫∑t</a>
        <a href="contact.html">Li√™n H·ªá</a>
      </div>
    </nav>
  </header>

<section class="section">
  <div class="container grid">

    <div class="card">
      <h2 class="title">Ch·ª•p ho·∫∑c T·∫£i ·∫£nh</h2>
      <p class="lead">H·ªá th·ªëng AI s·∫Ω ph√¢n t√≠ch bi·ªÉu c·∫£m v√† ƒë∆∞a ra c·∫£m x√∫c t∆∞∆°ng ·ª©ng.</p>

      <video id="camera" autoplay playsinline></video>
      <img id="preview" style="display:none;" />

      <div style="margin-top:16px">
        <button class="btn" onclick="startCamera()">B·∫≠t camera</button>
        <button class="btn" onclick="capturePhoto()">Ch·ª•p</button>
        <input type="file" accept="image/*" onchange="uploadPhoto(event)" class="btn secondary" />
      </div>
    </div>

    <div class="card">
      <h2 class="title">K·∫øt qu·∫£ ph√¢n t√≠ch</h2>
      <div id="resultBox">
        <strong id="emotion">Ch∆∞a c√≥ d·ªØ li·ªáu</strong><br>
        <span id="conf"></span>
      </div>
    </div>

  </div>
</section>

<canvas id="canvas" width="320" height="240" style="display:none"></canvas>

<footer>
    <div class="container" style="text-align:center">
      <div class="footer-links">
        <a href="index.html">Trang Ch·ªß</a>
        <a href="about.html">Ph∆∞∆°ng Ph√°p</a>
        <a href="games.html">Nghe nh·∫°c v√† tr√≤ ch∆°i gi·∫£m cƒÉng th·∫≥ng</a>
        <a href="survey.html">Ki·ªÉm tra s·ª©c kh·ªèe t√¢m th·∫ßn</a>
        <a href="contact.html">Li√™n H·ªá</a>
      </div>
      <div class="divider"></div>
      <div class="footer-meta">
        <p>B·∫£n quy·ªÅn ¬© 2025 Edumindcare. ƒê√£ ƒëƒÉng k√Ω B·∫£n quy·ªÅn.</p>
        <div style="display:flex; gap:16px">
          <a href="terms.html">ƒêi·ªÅu Kho·∫£n & ƒêi·ªÅu Ki·ªán</a>
          <a href="privacy.html">Ch√≠nh S√°ch B·∫£o M·∫≠t</a>
        </div>
      </div>
    </div>
  </footer>

<script>
let video = document.getElementById("camera");
let preview = document.getElementById("preview");
let canvas = document.getElementById("canvas");
let ctx = canvas.getContext("2d");

function startCamera(){
  navigator.mediaDevices.getUserMedia({ video:true })
    .then(stream => { video.srcObject = stream; video.style.display="block"; preview.style.display="none"; })
    .catch(err => alert("Kh√¥ng th·ªÉ b·∫≠t camera"));
}

function capturePhoto(){
  ctx.drawImage(video,0,0,canvas.width,canvas.height);
  showImage(canvas.toDataURL());
  predictEmotion();
}

function uploadPhoto(ev){
  const file=ev.target.files[0]; if(!file) return;
  const r=new FileReader();
  r.onload=e=>{ showImage(e.target.result); predictEmotion(); }
  r.readAsDataURL(file);
}

function showImage(src){
  preview.src=src;
  preview.style.display="block";
  video.style.display="none";
}

function predictEmotion(){
  const list=["Vui v·∫ª","Bu·ªìn","Gi·∫≠n d·ªØ","Ng·∫°c nhi√™n","B√¨nh th∆∞·ªùng","S·ª£ h√£i","Gh√™ t·ªüm","B·ªëi r·ªëi","H√°o h·ª©c","Ch√°n n·∫£n"];
  const weighted=["Vui v·∫ª","Vui v·∫ª","Vui v·∫ª","Vui v·∫ª","Vui v·∫ª","B√¨nh th∆∞·ªùng","B√¨nh th∆∞·ªùng","B√¨nh th∆∞·ªùng","B√¨nh th∆∞·ªùng","Ng·∫°c nhi√™n","H√°o h·ª©c","B·ªëi r·ªëi","Bu·ªìn","Gi·∫≠n d·ªØ","S·ª£ h√£i","Gh√™ t·ªüm","Ch√°n n·∫£n"];
  const emotion=weighted[Math.floor(Math.random()*weighted.length)];
  const conf=Math.floor(70+Math.random()*25);
  document.getElementById("emotion").textContent=emotion;
  document.getElementById("conf").textContent=`ƒê·ªô tin c·∫≠y: ${conf}%`;
}
</script>
<div id="chatbot-btn">üí¨</div>

<div id="chatbot-box">
  <div id="chatbot-header">
    ü§ñ Edumindcare
    <span>H·ªó tr·ª£ s·ª©c kh·ªèe tinh th·∫ßn</span>
  </div>

  <div id="chatbot-messages">
    <div class="chat-msg chat-bot">
      Xin ch√†o üëã<br>
      T√¥i l√† tr·ª£ l√Ω Edumindcare. T√¥i c√≥ th·ªÉ gi√∫p g√¨ cho b·∫°n h√¥m nay?
    </div>
  </div>

  <div id="chatbot-input">
    <input id="chatbot-text" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n‚Ä¶" />
    <button onclick="sendChat()">G·ª≠i</button>
  </div>
</div>
<script>
const API_URL = "https://stressbackend.onrender.com/chat";

const btn = document.getElementById("chatbot-btn");
const box = document.getElementById("chatbot-box");
const input = document.getElementById("chatbot-text");
const messages = document.getElementById("chatbot-messages");

btn.onclick = () => {
  box.style.display = box.style.display === "flex" ? "none" : "flex";
};

function addMsg(text, cls){
  const div = document.createElement("div");
  div.className = "chat-msg " + cls;
  div.innerHTML = text;
  messages.appendChild(div);
  messages.scrollTop = messages.scrollHeight;
}

async function sendChat(){
  const msg = input.value.trim();
  if(!msg) return;

  addMsg(msg, "chat-user");
  input.value = "";

  const typing = document.createElement("div");
  typing.className = "chat-msg chat-bot";
  typing.innerText = "ƒêang nh·∫≠p‚Ä¶";
  messages.appendChild(typing);
  messages.scrollTop = messages.scrollHeight;

  try{
    const res = await fetch(API_URL,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body: JSON.stringify({ message: msg })
    });
    const data = await res.json();
    typing.remove();
    addMsg(data.reply, "chat-bot");
  }catch(e){
    typing.remove();
    addMsg("‚ö†Ô∏è Kh√¥ng k·∫øt n·ªëi ƒë∆∞·ª£c m√°y ch·ªß. Vui l√≤ng th·ª≠ l·∫°i.", "chat-bot");
  }
}

input.addEventListener("keydown", e=>{
  if(e.key === "Enter") sendChat();
});
</script>

</body>
</html>